bad_times = [
             '2008:292:00:00:00.000 2008:296:00:00:00.000',
             '2010:149:00:00:00.000 2010:153:00:00:00.000',
             '2011:187:12:00:00.000 2011:192:04:00:00.000',
             '2011:299:00:00:00.000 2011:300:12:00:00.000',
             '2008:003:20:10:30.456 2008:003:20:22:11.931',
             '2008:003:20:12:15.006 2008:003:20:22:17.056',
             '2008:037:22:24:30.474 2008:037:22:37:37.024',
             '2008:164:19:46:43.357 2008:164:19:57:05.907',
             '2008:208:21:06:16.138 2008:208:21:47:20.713',
	     '2008:212:04:40:51.340 2008:212:05:21:23.115',
	     '2008:214:21:10:40.491 2008:214:21:51:18.416',
	     '2008:217:11:01:33.043 2008:217:11:41:36.118',
	     '2008:220:20:33:52.544 2008:220:21:14:40.719',
	     '2008:222:18:01:48.645 2008:222:18:41:55.820',
	     '2008:227:22:11:33.723 2008:227:22:51:59.348',
	     '2008:233:05:08:56.101 2008:233:05:50:36.551',
	     '2008:235:23:12:45.827 2008:235:23:53:03.252',
	     '2008:237:17:19:47.928 2008:237:18:00:13.553',
	     '2008:238:14:53:13.753 2008:238:15:33:17.853',
	     '2008:243:15:28:05.356 2008:243:16:08:09.456',
	     '2008:243:15:29:14.031 2008:243:16:09:31.456',
	     '2008:301:22:11:08.999 2008:301:22:21:13.099',
             '2008:301:22:11:14.124 2008:301:22:21:15.149',
             '2008:360:19:00:10.475 2008:360:19:10:55.575',
   	     '2009:330:13:09:27.198 2009:330:13:20:13.323',
   	     '2009:349:02:01:09.304 2009:349:02:12:17.979',
   	     '2010:044:16:05:30.073 2010:044:16:48:10.998',
	     '2011:153:01:20:24.336 2011:153:02:04:46.736',
	     '2011:187:12:23:44.974 2011:187:12:34:04.097',
   	     '2011:264:04:55:53.942 2011:264:05:38:17.442',
   	     '2011:182:05:00:00.000 2011:182:06:00:00.000',
   	     '2008:037:22:00:00.000 2008:037:23:30:00.000']

x = fetch.Msidset(['aopssupm', 'aopcadmd', 'pitch', 'roll', 'pitch_fss', 'roll_fss', 'aoacaseq'],
                  '2009:001', '2012:144')
x.interpolate(1.025)

for msid in x.keys():
    x[msid].filter_bad_times(table=bad_times)

ok = (x['aoacaseq'].vals == 'KALM') & (x['aopcadmd'].vals == 'NPNT') & ( x['pitch'].vals > 136) & (x['pitch'].vals < 148)


times = x['aopssupm'].times[ok]
pitch = x['pitch'].vals[ok]
roll = x['roll'].vals[ok]
pitch_fss = x['pitch_fss'].vals[ok]
roll_fss = x['roll_fss'].vals[ok]
sunmon = x['aopssupm'].vals[ok]
sme = sunmon == 'ACT '

pitch_err = pitch - pitch_fss
roll_err = roll - roll_fss

figure(1)
clf()
plot(pitch, pitch_err, ',')
figure(2)
clf()
plot(roll, roll_err, ',')
figure(3)
clf()
plot(pitch,roll_err, ',')
plot(pitch[sme], roll_err[sme], 'or', markeredgecolor='r')

bad = abs(roll_err) > 5
figure(4)
clf()
plot_cxctime(times[bad], roll_err[bad], ',')

figure(5)
clf()
scatter(pitch, roll_err, c=times, edgecolor='none')
